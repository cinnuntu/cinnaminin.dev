<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/social.css">
  <title>Social | Cinnaminin.dev</title>
</head>
<body>
<div class="dashboard">
  <div class="header">
    <a href="index.html" class="header-link">Home</a>
    <a href="projects.html" class="header-link">Projects</a>
    <a href="social.html" class="header-link">Social</a>
    <a href="credits.html" class="header-link">Credits</a>
  </div>

  <div class="social-container">
    <h2>Find Me On:</h2>

    <!-- Steam Profile -->
    <a href="https://steamcommunity.com/profiles/76561199106604159" class="social-profile-link">
      <div class="social-profile steam" style="background-image: url('assets/steam/winter24background.gif'); background-size: cover; background-position: center;">
        <div class="profile-header">
          <div class="steam-avatar-frame">
            <img src="assets/steam/lilith_cake_steam_pfp.gif" alt="Steam Profile Picture" class="steam-pfp">
            <img src="assets/steam/winter24_frame.gif" class="steam-frame" alt="Avatar Frame">
          </div>
          <div class="profile-info">
            <h3 class="steam-profilename">Cinnaminin</h3>
            <p class="profile-bio">Crasher Of Castles <br>I CANNOT WAIT FOR THE PAINTERS PARADISE DLC!!</p>
            <p class="profile-more-info">View more info</p>
            <div class="profile-stats">
              <div class="stat">
                <img src="assets/steam/steam_icon.png" alt="Steam Icon" class="stat-icon">
                <span id="steam-level">Level: 15</span>
              </div>
              <div class="stat">
                <img src="assets/steam/gameicon.png" alt="Games Icon" class="stat-icon">
                <span id="steam-games">Games: 39</span>
              </div>
              <div class="stat">
                <img src="assets/steam/statusicon.png" alt="Status Icon" class="stat-icon">
                <span id="steam-status">Loading status...</span>
              </div>
            </div>
          </div>
          <img src="assets/steam/steam_icon.png" alt="Steam Logo" class="website-logo">
        </div>
      </div>
    </a>

    <!-- Modrinth Profile -->
    <a href="https://modrinth.com/user/Cinnaminin" class="social-profile-link">
      <div class="social-profile modrinth">
        <div class="profile-header">
          <img src="assets/modrinth_pfp.png" alt="Modrinth Profile Picture" class="modrinth-pfp">
          <div class="profile-info">
            <h3 class="modrinth-profilename">Cinnaminin</h3>
            <p class="profile-bio" id="modrinth-bio">Hello! You can call me Cinnamon, i just make minecraft mods and really anything<br> minecraft related (Texture packs, mods, servers)</p>
            <div class="profile-stats">
              <div class="stat">
                <img src="assets/modrimth/default_icon.png" alt="Projects Icon" class="stat-icon">
                <span id="modrinth-projects">Loading projects...</span>
              </div>
              <div class="stat">
                <img src="assets/modrimth/download_icon.png" alt="Downloads Icon" class="stat-icon">
                <span id="modrinth-downloads">Loading downloads...</span>
              </div>
              <div class="stat">
                <img src="assets/modrimth/calender.png" alt="Joined Icon" class="stat-icon">
                <span id="modrinth-joined">Loading join date...</span>
              </div>
            </div>
          </div>
          <img src="assets/modrimth/modrinth_icon.png" alt="Modrinth Logo" class="website-logo">
        </div>
      </div>
    </a>

    <!-- YouTube Profile -->
    <a href="https://youtube.com/@cinnamininn" class="social-profile-link">
      <div class="social-profile youtube">
        <div class="profile-header">
          <img src="assets/yt/youtube_pfp.jpg" alt="YouTube Profile Picture" class="youtube-pfp">
          <div class="profile-info">
            <h3 class="youtube-profilename">Cinnaminin</h3>
            <p class="profile-bio">@cinnamininn • 41 Subscribers • 7 Videos</p>
            <div class="profile-stats">
              <div class="stat">
                <span>What do I put here? Oh things about me. Umm... I play games and make videos. And play...</span>
              </div>
            </div>
            <div class="yt-link">
              <a href="https://youtube.com/channel/UCBw-42Ahba3ab187rSD50LA?sub_confirmation=1" target="_blank" class="yt-link-text">
                youtube.com/channel/UCBw-42Ahba3ab187rSD50LA?sub_confirmation=1
              </a>
            </div>
          </div>
          <img src="assets/yt/yt_icon.png" alt="YouTube Logo" class="website-logo">
        </div>
      </div>
    </a>

    <a href="https://github.com/Cinnaminin" class="social-profile-link">
      <div class="social-profile github">
        <div class="profile-header">
          <img src="assets/github/github_pfp.png" alt="Github Profile Picture" class="github-pfp">
          <div class="profile-info">
            <h3 class="github-profilename">Cinnaminin</h3>
            <p class="profile-bio github"> cinnaminin</p>
            <div class="profile-stats">
              <div class="stat">
                <img src="assets/github/domain_icon.png" alt="Domain" class="stat-icon">
                <span>CinnamininStudios</span>
              </div>
              <div class="stat">
                <img src="assets/github/location_icon.png" alt="Location Icon" class="stat-icon">
                <span>My House?</span>
              </div>
              <div class="stat">
                <img src="assets/github/time_icon.png" alt="TimeZone Icon" class="stat-icon">
                <span id="timezone">Loading Time...</span>
              </div>
            </div>
          </div>
          <img src="assets/github/github_icon.png" alt="Github Logo" class="website-logo">
        </div>
      </div>
    </a>

  </div>
</div>

<script>
  const steamID64 = '76561199106604159';
  const proxyBaseURL = 'https://steam-proxy-for-cinnaminin-dev.onrender.com';

  function fetchSteamData() {
    // Fetch profile summary (status, avatar, name, etc.)
    fetch(`${proxyBaseURL}/steam/summary/${steamID64}`)
      .then(res => res.json())
      .then(data => {
        const player = data.response.players[0];
        const statusMap = ['Offline', 'Online', 'Busy', 'Away', 'Snooze', 'Looking to Trade', 'Looking to Play'];
        const status = statusMap[player.personastate] || 'Unknown';

        document.getElementById('steam-status').textContent = `Status: ${status}`;
        document.getElementById('steam-avatar').src = player.avatarfull;
        document.getElementById('steam-profile-link').href = player.profileurl;
        document.querySelector('.steam-profilename').textContent = player.personaname;
      })
      .catch(() => {
        document.getElementById('steam-status').textContent = `Status: Unknown`;
      });

    // Fetch Steam level
    fetch(`${proxyBaseURL}/steam/level/${steamID64}`)
      .then(res => res.json())
      .then(data => {
        document.getElementById('steam-level').textContent = `Level ${data.response.player_level}`;
      });

    // Fetch game count
    fetch(`${proxyBaseURL}/steam/games/${steamID64}`)
      .then(res => res.json())
      .then(data => {
        document.getElementById('steam-games').textContent = `${data.response.game_count} Games`;
      });
  }

  window.onload = () => {
    fetchSteamData();
  }

  function getCurrentTimeInGMTMinus5() {
    const now = new Date();
    const offset = -4 * 60;
    now.setMinutes(now.getMinutes() + now.getTimezoneOffset() + offset);

    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    return `${hours}:${minutes}`;
  }

  function getUserTimeZoneDifference() {
    const userOffset = -new Date().getTimezoneOffset() / 60;
    const referenceOffset = -4;
    const difference = userOffset - referenceOffset;

    if (difference === 0) return "Same Time";
    if (difference > 0) return `+${difference}hr`;
    return `${difference}hr`;
  }

  function fetchModrinthStats() {
    fetch('https://api.modrinth.com/v2/user/Cinnaminin/projects')
      .then(response => response.json())
      .then(projects => {
        const totalDownloads = projects.reduce((sum, project) => sum + (project.downloads || 0), 0);
        document.getElementById('modrinth-projects').textContent = `${projects.length} Projects`;
        document.getElementById('modrinth-downloads').textContent = `${totalDownloads.toLocaleString()} Downloads`;
      })
      .catch(() => {
        document.getElementById('modrinth-projects').textContent = 'Could Not Load';
        document.getElementById('modrinth-downloads').textContent = 'Could Not Load';
      });
  }

  function fetchModrinthJoinDate() {
    fetch('https://api.modrinth.com/v2/user/Cinnaminin')
      .then(response => response.json())
      .then(data => {
        const joinedDate = new Date(data.created);
        const now = new Date();
        const diffTime = Math.abs(now - joinedDate);
        const diffMonths = Math.floor(diffTime / (1000 * 60 * 60 * 24 * 30));
        const diffYears = Math.floor(diffMonths / 12);
        const remainingMonths = diffMonths % 12;

        let joinedText = 'Joined ';
        if (diffYears > 0) joinedText += `${diffYears} year${diffYears > 1 ? 's' : ''} `;
        if (remainingMonths > 0) joinedText += `${remainingMonths} month${remainingMonths > 1 ? 's' : ''}`;
        if (diffYears === 0 && remainingMonths === 0) joinedText += 'just now';

        document.getElementById('modrinth-joined').textContent = joinedText.trim();
      })
      .catch(() => {
        document.getElementById('modrinth-joined').textContent = 'Joined June 2024';
      });
  }

  window.onload = () => {
    fetchModrinthStats();
    fetchModrinthJoinDate();
    fetchSteamData();

    const time = getCurrentTimeInGMTMinus5();
    const diff = getUserTimeZoneDifference();
    document.getElementById('timezone').textContent = `${time} (${diff})`;
  };
</script>

</body>
</html>
